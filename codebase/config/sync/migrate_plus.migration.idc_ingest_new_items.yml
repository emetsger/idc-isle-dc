uuid: 2c14b68f-1c0c-446e-99cf-bc2bbd0e346c
langcode: en
status: true
dependencies: {  }
id: idc_ingest_new_items
class: null
field_plugin_method: null
cck_plugin_method: null
migration_tags: null
migration_group: idc_ingest
label: '(2) Ingest New Repository Items'
source:
  plugin: csv
  ids:
    - local_id
  path: 'Will be populated by the Migrate Source UI'
process:
  field_member_of:
    plugin: migration_lookup
    migration: idc_ingest_new_collection
    source: collectionid_local
    no_stub: true
  field_model:
    plugin: entity_lookup
    bundle_key: vid
    bundle: islandora_models
    entity_type: taxonomy_term
    value_key: name
    source: model
  field_display_hints:
    plugin: entity_lookup
    bundle_key: vid
    bundle: islandora_display
    entity_type: taxonomy_term
    value_key: name
    source: display_hint
  field_resource_type:
    plugin: entity_lookup
    bundle_key: vid
    bundle: resource_types
    entity_type: taxonomy_term
    value_key: name
    source: resource_type
  title: title
  field_description: description
#  psf_linked_agent:
#    -
#      plugin: log
#      source: linked_agent
#    -
#      plugin: explode
#      delimiter: ;
#    -
#      plugin: log
#    -
#      plugin: deepen
#      keyname: agents
#    -
#      plugin: log
  psf_linked_agent:
    -
      plugin: log
      source: linked_agent
    -
      plugin: explode
      source: linked_agent
      delimiter: '|'
    -
      plugin: callback
      callable: trim
    -
      plugin: log
    -
      plugin: deepen
      keyname: agents
    -
      plugin: sub_process
      process:
        target_id:
          -
            plugin: explode
            source: agents
            delimiter: ;
          -
            plugin: log
          -
            plugin: extract
            index:
              - 1
          -
            plugin: explode
            delimiter: /
          -
            plugin: array_pop
          -
            plugin: log
        rel_type:
          -
            plugin: explode
            source: agents
            delimiter: ;
          -
            plugin: log
          -
            plugin: extract
            index:
              - 0
          -
            plugin: log
        psf_moo:
          -
            plugin: get
            source:
              - '@psf_target_id'
              - '@psf_rel_type'
          -
            plugin: log
#    - plugin: callback
#      callable: trim
    - plugin: log
  field_linked_agent: '@psf_linked_agent'
destination:
  plugin: 'entity:node'
  default_bundle: islandora_object
migration_dependencies: null
